# Fluent Bit: ログ収集 -> Elasticsearch
# Docker Forward プロトコルでコンテナログを受信し、Elasticsearch へ送信

[SERVICE]
    Flush         5
    Log_Level     info
    Daemon        off

# Docker ロギングドライバ (fluentd) から受信
[INPUT]
    Name          forward
    Listen        0.0.0.0
    Port          24224

# コンテナメタデータを付与（Docker 経由で送られてくるタグを利用）
[FILTER]
    Name          modify
    Match         *
    Add           log_type docker

# Elasticsearch へ出力
[OUTPUT]
    Name          es
    Match         *
    Host          elasticsearch
    Port          9200
    Index         fluent-bit
    Type          _doc
    Replace_Dots  On
    Logstash_Format On
    Logstash_Prefix fluent-bit
    Logstash_DateFormat %Y.%m.%d
    Time_Key      @timestamp
    Include_Tag_Key On
    Tag_Key       tag
